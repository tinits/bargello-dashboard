<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Taller de Bordado Bargello Tinicrafts</title>
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Marked.js para markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- PapaParse para CSV -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container flex justify-between items-center">
            <h1 class="header__title">üßµ Taller Bargello Tinicrafts</h1>
            <div class="header__status">
                <div class="health-status" id="currentHealthStatus">
                    Estado: Sin registro
                </div>
                <button class="btn btn--primary btn--sm" id="healthRegisterBtn">
                    üìù Registrar Salud
                </button>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar__header">
                <h3>Navegaci√≥n</h3>
            </div>
            <nav>
                <ul class="sidebar__menu">
                    <li class="sidebar__item">
                        <button class="sidebar__link active" data-view="dashboard">
                            üìä Dashboard Principal
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="salud">
                            üíö Gesti√≥n de Salud
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="tareas">
                            ‚úÖ Gesti√≥n de Tareas
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="timeline">
                            üìÖ Timeline y Cronograma
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="markdown">
                            üìù Editor de Markdown
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="redes">
                            üì± Gesti√≥n de Redes Sociales
                        </button>
                    </li>
                    <li class="sidebar__item">
                        <button class="sidebar__link" data-view="datos">
                            üíæ Gesti√≥n de Datos
                        </button>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Dashboard Principal -->
            <div id="dashboard-view" class="view active">
                <div class="view__header">
                    <h2>Dashboard Principal</h2>
                    <div class="view__actions">
                        <button class="btn btn--secondary" onclick="window.dashboard.sincronizarDatos()">
                            üîÑ Sincronizar
                        </button>
                        <button class="btn btn--primary" onclick="window.dashboard.exportarCSV()">
                            üì§ Exportar CSV
                        </button>
                    </div>
                </div>
                
                <div class="dashboard-grid">
                    <!-- Estado de Salud Actual -->
                    <div class="card">
                        <div class="card__body">
                            <h3>Estado de Salud Actual</h3>
                            <div id="healthStatus">
                                <p>No hay registro de hoy</p>
                            </div>
                        </div>
                    </div>

                    <!-- Capacidad de Trabajo -->
                    <div class="card">
                        <div class="card__body">
                            <h3>Capacidad de Trabajo</h3>
                            <div id="workCapacity">
                                <p>Registra tu estado para calcular capacidad</p>
                            </div>
                        </div>
                    </div>

                    <!-- Tareas Sugeridas -->
                    <div class="card">
                        <div class="card__body">
                            <h3>Tareas Sugeridas</h3>
                            <div id="suggestedTasks">
                                <p>No hay sugerencias disponibles</p>
                            </div>
                        </div>
                    </div>

                    <!-- Progreso de M√≥dulos -->
                    <div class="card">
                        <div class="card__body">
                            <h3>Progreso de M√≥dulos</h3>
                            <canvas id="moduleProgressChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de Salud -->
            <div id="salud-view" class="view">
                <div class="view__header">
                    <h2>Gesti√≥n de Salud y Bienestar</h2>
                </div>
                
                <div class="health-section">
                    <div class="card">
                        <div class="card__body">
                            <h3>Registro Diario</h3>
                            <form id="healthForm" class="health-form">
                                <div class="form-group">
                                    <label for="dolorSlider" class="form-label">
                                        Nivel de Dolor: <span id="dolorValue">5</span>/10
                                    </label>
                                    <input type="range" id="dolorSlider" min="1" max="10" value="5" class="form-control">
                                </div>
                                
                                <div class="form-group">
                                    <label for="fatigaSlider" class="form-label">
                                        Nivel de Fatiga: <span id="fatigaValue">5</span>/10
                                    </label>
                                    <input type="range" id="fatigaSlider" min="1" max="10" value="5" class="form-control">
                                </div>
                                
                                <div class="form-group">
                                    <label for="suenoSlider" class="form-label">
                                        Horas de Sue√±o: <span id="suenoValue">7</span>
                                    </label>
                                    <input type="range" id="suenoSlider" min="3" max="12" value="7" class="form-control">
                                </div>
                                
                                <button type="submit" class="btn btn--primary btn--full-width">
                                    üíæ Guardar Registro de Salud
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__body">
                            <h3>Historial (√∫ltimos 30 d√≠as)</h3>
                            <canvas id="healthChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de Tareas -->
            <div id="tareas-view" class="view">
                <div class="view__header">
                    <h2>Gesti√≥n de Tareas</h2>
                    <div class="view__actions">
                        <button class="btn btn--primary" id="addTaskBtn">
                            ‚ûï Nueva Tarea
                        </button>
                        <button class="btn btn--secondary" id="exportTasksBtn">
                            üì§ Exportar Tareas
                        </button>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="card tasks-filters">
                    <div class="card__body">
                        <div class="filters-row">
                            <div class="form-group">
                                <label for="searchTasks" class="form-label">Buscar tareas</label>
                                <input type="text" id="searchTasks" class="form-control" placeholder="Buscar por nombre o descripci√≥n...">
                            </div>
                            <div class="form-group">
                                <label for="filterModule" class="form-label">Filtrar por m√≥dulo</label>
                                <select id="filterModule" class="form-control">
                                    <option value="">Todos los m√≥dulos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterStatus" class="form-label">Filtrar por estado</label>
                                <select id="filterStatus" class="form-control">
                                    <option value="">Todos los estados</option>
                                    <option value="pendiente">Pendiente</option>
                                    <option value="en progreso">En Progreso</option>
                                    <option value="completado">Completado</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de Tareas -->
                <div class="card">
                    <div class="tasks-table-container">
                        <table class="tasks-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>M√≥dulo</th>
                                    <th>Estado</th>
                                    <th>Progreso</th>
                                    <th>Fecha L√≠mite</th>
                                    <th>Prioridad</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="tasksTableBody">
                                <!-- Tareas se cargar√°n din√°micamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Timeline y Cronograma -->
            <div id="timeline-view" class="view">
                <div class="view__header">
                    <h2>Timeline y Cronograma</h2>
                </div>
                
                <div class="timeline-container">
                    <div class="timeline-controls">
                        <button class="btn btn--secondary" id="prevWeek">‚Üê Semana Anterior</button>
                        <h3 id="currentWeekLabel">Semana Actual</h3>
                        <button class="btn btn--secondary" id="nextWeek">Semana Siguiente ‚Üí</button>
                    </div>
                    
                    <div class="timeline-grid" id="timelineGrid">
                        <!-- Timeline se generar√° din√°micamente -->
                    </div>
                </div>
            </div>

            <!-- Editor de Markdown -->
            <div id="markdown-view" class="view">
                <div class="view__header">
                    <h2>Editor de Markdown</h2>
                    <div class="view__actions">
                        <button class="btn btn--primary" id="newMarkdownFile">
                            üìÑ Nuevo Archivo
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card__body">
                        <div class="form-group">
                            <label for="mdFileSelect" class="form-label">Seleccionar archivo .md</label>
                            <select id="mdFileSelect" class="form-control">
                                <option value="">Selecciona un archivo...</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="card markdown-editor">
                    <div class="markdown-tabs">
                        <button class="tab-btn active" data-tab="editor">üìù Editor</button>
                        <button class="tab-btn" data-tab="preview">üëÅÔ∏è Vista Previa</button>
                    </div>
                    
                    <div class="markdown-content">
                        <textarea id="markdownEditor" placeholder="Escribe aqu√≠ tu contenido en Markdown..."></textarea>
                        <div id="markdownPreview" class="markdown-preview" style="display: none;"></div>
                    </div>
                    
                    <div class="markdown-actions">
                        <button class="btn btn--primary" id="saveMarkdown">
                            üíæ Guardar
                        </button>
                        <button class="btn btn--secondary" onclick="window.dashboard.cambiarTabMarkdown('preview')">
                            üëÅÔ∏è Vista Previa
                        </button>
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de Redes Sociales -->
            <div id="redes-view" class="view">
                <div class="view__header">
                    <h2>Gesti√≥n de Redes Sociales</h2>
                </div>
                
                <div class="card social-calendar">
                    <div class="card__body">
                        <h3>Calendario de Contenido</h3>
                        <div class="calendar-grid" id="socialCalendar">
                            <!-- Calendario se generar√° din√°micamente -->
                        </div>
                    </div>
                </div>

                <div class="social-suggestions">
                    <div class="card">
                        <div class="card__body">
                            <h3>Sugerencias de Contenido</h3>
                            <div id="contentSuggestions">
                                <h4>üì∏ Instagram</h4>
                                <ul>
                                    <li>Time-lapse del patr√≥n actual en desarrollo</li>
                                    <li>Fotos del antes y despu√©s de proyectos</li>
                                    <li>Stories con tips de ergonom√≠a para fibromialgia</li>
                                </ul>
                                
                                <h4>üé• YouTube</h4>
                                <ul>
                                    <li>Tutorial completo del m√≥dulo en progreso</li>
                                    <li>Video sobre historia del Bargello</li>
                                    <li>Sesi√≥n de preguntas y respuestas</li>
                                </ul>
                                
                                <h4>üìå Pinterest</h4>
                                <ul>
                                    <li>Infograf√≠a de t√©cnicas b√°sicas</li>
                                    <li>Paleta de colores del proyecto actual</li>
                                    <li>Pins de inspiraci√≥n hist√≥rica</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de Datos -->
            <div id="datos-view" class="view">
                <div class="view__header">
                    <h2>Gesti√≥n de Datos</h2>
                </div>
                
                <div class="data-management">
                    <div class="card">
                        <div class="card__body">
                            <h3>Importar/Exportar CSV</h3>
                            <div class="flex flex-col gap-16">
                                <div>
                                    <label for="csvFileInput" class="form-label">Cargar archivo CSV</label>
                                    <input type="file" id="csvFileInput" accept=".csv" class="form-control">
                                    <button class="btn btn--primary mt-8" id="loadCSV">
                                        üì• Cargar CSV
                                    </button>
                                </div>
                                
                                <div>
                                    <button class="btn btn--secondary btn--full-width" id="exportCSV">
                                        üì§ Exportar CSV Actual
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__body">
                            <h3>Configuraci√≥n de Respaldo</h3>
                            <div class="flex flex-col gap-16">
                                <button class="btn btn--primary" id="syncData">
                                    üîÑ Sincronizar Datos
                                </button>
                                <button class="btn btn--warning" id="resetData">
                                    üóëÔ∏è Resetear Datos
                                </button>
                                <p class="mt-8">
                                    <strong>√öltima sincronizaci√≥n:</strong> 
                                    <span id="lastSync">No disponible</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Modal para Tareas -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="taskModalTitle">Nueva Tarea</h3>
                <button class="modal-close" id="closeTaskModal">√ó</button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <div class="form-group">
                        <label for="taskName" class="form-label">Nombre de la tarea *</label>
                        <input type="text" id="taskName" name="nombre" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDescription" class="form-label">Descripci√≥n</label>
                        <textarea id="taskDescription" name="descripcion" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskModule" class="form-label">M√≥dulo</label>
                        <select id="taskModule" name="modulo" class="form-control">
                            <option value="0">M√≥dulo 0 - Biblioteca Base</option>
                            <option value="1">M√≥dulo 1 - Fundamentos</option>
                            <option value="2">M√≥dulo 2 - T√©cnicas B√°sicas</option>
                            <option value="3">M√≥dulo 3 - Profundizaci√≥n</option>
                            <option value="4">M√≥dulo 4 - Transferencia</option>
                            <option value="5">M√≥dulo 5 - Finalizaci√≥n</option>
                            <option value="6">M√≥dulo 6 - Materiales Especiales</option>
                            <option value="7">M√≥dulo 7 - Escalas</option>
                            <option value="8">M√≥dulo 8 - Variaciones</option>
                            <option value="9">M√≥dulo 9 - Bordes</option>
                            <option value="10">M√≥dulo 10 - Composiciones</option>
                            <option value="11">M√≥dulo 11 - Canvaswork</option>
                            <option value="12">M√≥dulo 12 - Proyectos Finales</option>
                            <option value="13">M√≥dulo 13 - Maestr√≠a</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskSection" class="form-label">Secci√≥n</label>
                        <input type="text" id="taskSection" name="seccion" class="form-control" placeholder="Ej: Biblioteca Base, Fundamentos, etc.">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskStartDate" class="form-label">Fecha de inicio</label>
                        <input type="date" id="taskStartDate" name="fecha_inicio" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskEndDate" class="form-label">Fecha l√≠mite</label>
                        <input type="date" id="taskEndDate" name="fecha_limite" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDuration" class="form-label">Duraci√≥n estimada (horas)</label>
                        <input type="number" id="taskDuration" name="duracion_estimada" class="form-control" min="0.5" step="0.5">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskPriority" class="form-label">Prioridad</label>
                        <select id="taskPriority" name="prioridad" class="form-control">
                            <option value="alta">Alta</option>
                            <option value="media">Media</option>
                            <option value="baja">Baja</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskStatus" class="form-label">Estado</label>
                        <select id="taskStatus" name="estado" class="form-control">
                            <option value="pendiente">Pendiente</option>
                            <option value="en progreso">En Progreso</option>
                            <option value="completado">Completado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskProgress" class="form-label">
                            Progreso: <span id="taskProgressValue">0%</span>
                        </label>
                        <input type="range" id="taskProgress" name="progreso" class="form-control" min="0" max="100" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskResponsible" class="form-label">Responsable</label>
                        <input type="text" id="taskResponsible" name="responsable" class="form-control" value="Tini Sanhueza">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskNotes" class="form-label">Notas adicionales</label>
                        <textarea id="taskNotes" name="notas" class="form-control" rows="3" placeholder="Notas, comentarios o detalles adicionales..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn--secondary" id="cancelTask">Cancelar</button>
                <button type="submit" form="taskForm" class="btn btn--primary">Guardar Tarea</button>
            </div>
        </div>
    </div>

    <!-- Contenedor de Notificaciones -->
    <div id="notifications" class="notifications"></div>

    <!-- Script principal -->
    <script src="app.js"></script>
    
    <!-- Inicializaci√≥n -->
    <script>
        // Inicializar el dashboard cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            window.dashboard = new BargelloDashboard();
            
            // Solicitar permisos de notificaci√≥n si es necesario
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        });
    </script>
</body>
</html>
